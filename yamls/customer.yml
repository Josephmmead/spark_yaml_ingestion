inputs:
  customer:
    location: '.\spark_yaml_ingestion\data\customer.csv'
    type: 'type1'
    dataframe: 'customer_df'
    schema: customer_schema

  transaction:
    location: '.\spark_yaml_ingestion\data\transactions.csv'
    type: 'type1'
    dataframe: 'transaction_df'
    schema: transaction_schema

sql_statements:
  - name: join_dataframes
    query: SELECT customer_df.customer, customer_df.customer_id, transaction_df.transaction_id, transaction_df.transaction_amount FROM customer_df JOIN transaction_df On customer_df.customer_id = transaction_df.customer_id
    temp_table: true
    drop_temp_views: ['customer_df', 'transaction_df']
  - name: greater_than_100
    query: Select * from join_dataframes where transaction_amount > 100.00
    temp_table: false
    drop_temp_views: []
    


